## 计算方法实验一

PB19030888张舒恒

2022 年 3 月 10 日 

### 问题详述

![pj1](C:\Users\凝雨\Desktop\pj1.png)

### 算法设计

#### 	Lagrange 插值

​	内存循环每次乘上一个因子```(test - x[j]) / (x[i] - x[j])```，最后乘上前置系数```y[i]```累加到结果中，算法时间复杂度$O(n)$。

```c++
for(auto i = 0; i < n; i++){
    for(auto j = 0; j < n; j++){
        if(j != i)
            l[i] *=  (test - x[j]) / (x[i] - x[j]);
    }
    re += l[i] * y[i];
}
```

#### 	Newton 插值

​	两层循环计算差商$a[i][j]$，再将$(x - a[0][j])$累乘，最后乘上相应的差商累加到结果中，算法时间复杂度$O(n)$。

```c++
for (i = 2; i <= n; i++)
    for (j = i - 1, k = 0; j < n; j++, k++)
        a[i][j] = (a[i-1][j] - a[i-1][j-1]) / (a[0][j] - a[0][k]);
for (i = 2; i <= n; i++){
    sum = 1;
    for (j = i-2; j >= 0; j--)
        sum = (x - a[0][j]) * sum;
    //cout << a[i][i-1] << endl;
    sum = sum * a[i][i-1];
    y = sum + y;
}
```

### 输出结果

​	Lagrange 插值：预测1910年的人口为31872000人，1965年的人口为193082000人，2002年的人口为26138700人

​    Newton 插值：预测1965年的人口为193082000人，2012年的人口为-136453000人

### 误差分析

​	为了估计 Lagrange 插值在1965 年与 2002 年的计算结果的准确性，我们增加一个插值点 (1910,91772000)。

​	使用 1910、1920、1930、1940、1950、1960 插值的结果记为$L_{1}(x)$

​	使用 1920、1930、1940、1950、1960、1970 插值的结果记为$L_{2}(x)$

​	计算得出(单位千人)：

​	x = 1965，$L_{1}(x)$ = 178340，$L_{2}(x)$ = 193082

​	x = 2002，$L_{1}(x)$ = -3964443，$L_{2}(x)$ = 26139

​    根据教材公式$f\left( x\right) -L_{n}\left( x\right) \approx \dfrac{x-x_{0}}{x_{0}-x_{n+1}}\left( L_{n}\left( x\right) -\widetilde{L_{n}}\left( x\right) \right)$计算得出：

​	x = 1965，$f\left( x\right) -L_{2}\left( x\right) \approx$ 13513  

​	x = 2002，$f\left( x\right) -L_{2}\left( x\right) \approx$  6118893

​	所以 Lagrange 插值在 1965 年与 2002 年的计算结果均与实际情况存在较大误差，此次计算结果的准确性较小。

### 实验总结

​	Lagrange 与 Newton 插值计算结果均与实际情况存在较大误差。待计算的函数点在插值区间内时，插值得到的结果误差较小；待计算的函数点不在插值区间内时，插值得到的结果误差较大。Lagrange 与 Newton 插值方法均只对于多项式拟合规律的插值点效果较好，如果数值点分布并不遵循多项式拟合走势，则两种方法拟合效果较差。

### 参考资料

​	[1]数值计算方法与算法.第三版.张韵华,王新茂编